<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1080, initial-scale=1.0">
    <title>Totem Unime</title>

    <script>
        (function() {
            try {
                const building = new URLSearchParams(window.location.search).get('building') || 'totem_A';
                const bgMap = {'totem_A':'totem_A.jpg','totem_B':'totem_B.jpg','totem_SBA':'totem_SBA.jpg'};

                // Funzione per nascondere il loader
                const hideLoader = () => {
                    const loader = document.getElementById('loader');
                    if (loader) {
                        loader.classList.add('hidden');
                    }
                };

                if (building && bgMap[building]) {
                    const imageUrl = `/totem/assets/${bgMap[building]}`;
                    const preloader = new Image();
                    
                    // QUANDO l'immagine di sfondo è pronta...
                    preloader.onload = function() {
                        document.documentElement.style.backgroundImage = `url('${imageUrl}')`;
                        hideLoader(); // ...nascondi il loader
                    };
                    
                    // In caso di errore, nascondi comunque il loader per non bloccare la pagina
                    preloader.onerror = function() {
                        console.error("Impossibile caricare l'immagine di sfondo.");
                        hideLoader();
                    };

                    // Avvia il download dell'immagine
                    preloader.src = imageUrl;

                } else {
                    // Se non c'è un'immagine, nascondi il loader quando il DOM è pronto
                    document.addEventListener('DOMContentLoaded', hideLoader);
                }
            } catch (e) { 
                console.error("Errore nello script di precaricamento:", e); 
                document.addEventListener('DOMContentLoaded', hideLoader);
            }
        })();
    </script>
    
    <link rel="stylesheet" href="/totem/static/css/common.css">
    <link rel="stylesheet" href="/totem/static/css/home.css">
    
    <link rel="icon" href="/totem/assets/favicon.ico" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="loader">
        <div class="spinner-container">
            <img src="/totem/assets/logo_unime.png" alt="Logo Unime" class="spinner-logo">
            <div class="spinner"></div>
        </div>
    </div>

    <div class="header-container">
        <span id="current-date"></span>
        <span id="current-time"></span>
    </div>

    <div class="menu-container">
        <nav class="main-menu">
            <a href="wayfinding.html" class="menu-button" id="wayfinding-link">Trova Aula</a>
            <a href="infopoint.html" class="menu-button" id="infopoint-link">News & Eventi</a>
        </nav>
    </div>

    <script src="/totem/static/js/home.js"></script>
</body>
</html>